\documentclass{beamer}
\usepackage[utf8]{inputenc}

\usetheme{Madrid}
\usecolortheme{default}
\usepackage{amsmath,amssymb,amsfonts,amsthm}
\usepackage{txfonts}
\usepackage{tkz-euclide}
\usepackage{listings}
\usepackage{adjustbox}
\usepackage{array}
\usepackage{tabularx}
\usepackage{gvv}
\usepackage{lmodern}
\usepackage{circuitikz}
\usepackage{tikz}
\usepackage{graphicx}

\setbeamertemplate{page number in head/foot}[totalframenumber]

\usepackage{tcolorbox}
\tcbuselibrary{minted,breakable,xparse,skins}



\definecolor{bg}{gray}{0.95}
\DeclareTCBListing{mintedbox}{O{}m!O{}}{%
  breakable=true,
  listing engine=minted,
  listing only,
  minted language=#2,
  minted style=default,
  minted options={%
    linenos,
    gobble=0,
    breaklines=true,
    breakafter=,,
    fontsize=\small,
    numbersep=8pt,
    #1},
  boxsep=0pt,
  left skip=0pt,
  right skip=0pt,
  left=25pt,
  right=0pt,
  top=3pt,
  bottom=3pt,
  arc=5pt,
  leftrule=0pt,
  rightrule=0pt,
  bottomrule=2pt,
  toprule=2pt,
  colback=bg,
  colframe=orange!70,
  enhanced,
  overlay={%
    \begin{tcbclipinterior}
    \fill[orange!20!white] (frame.south west) rectangle ([xshift=20pt]frame.north west);
    \end{tcbclipinterior}},
  #3,
}
\lstset{
    language=C,
    basicstyle=\ttfamily\small,
    keywordstyle=\color{blue},
    stringstyle=\color{orange},
    commentstyle=\color{green!60!black},
    numbers=left,
    numberstyle=\tiny\color{gray},
    breaklines=true,
    showstringspaces=false,
}
%------------------------------------------------------------
%This block of code defines the information to appear in the
%Title page
\title %optional
{5.5.1}
\date{}
%\subtitle{A short story}

\author % (optional)
{Sai Krishna Bakki - EE25BTECH11049}

\begin{document}
\frame{\titlepage}
\begin{frame}{Question}
If $\vec{A}=\myvec{5&-1&4\\2&3&5\\5&-2&6}$, find $\vec{A}^{-1}$ and use it to solve the following system of equations
\begin{align*}
    5x-y+4z=5\\
    2x+3y+5z=2\\
    5x-2y+6z=-1
\end{align*}
\end{frame}

\begin{frame}{Theoretical Solution}
    \begin{align}
        \augvec{3}{3}{5&-1&4& 1& 0&0\\ 2&3&5& 0& 1&0\\5&-2&6& 0& 0&1}
        &\xleftrightarrow{\,R_3 \gets R_3 - R_1}
        \augvec{3}{3}{5&-1&4& 1& 0&0\\ 2&3&5& 0& 1&0\\0&-1&2& -1& 0&1} \end{align}
        \begin{align}
        &\xleftrightarrow[\,R_2 \gets R_2 + 3R_3]{\,R_1 \gets R_1 - R_3}
        \augvec{3}{3}{5&0&2& 2& 0&-1\\ 2&0&11& -3& 1&3\\0&-1&2& -1& 0&1}\end{align}
        \begin{align}
        &\xleftrightarrow{\,R_3 \gets -R_3}
        \augvec{3}{3}{5&0&2& 2& 0&-1\\ 2&0&11& -3& 1&3\\0&1&-2& 1& 0&-1} 
\end{align}
\end{frame}
\begin{frame}{Theoretical Solution}
    \begin{align}
        &\xleftrightarrow{\,R_2 \leftrightarrow R_3}
        \augvec{3}{3}{5&0&2& 2& 0&-1\\ 0&1&-2& 1& 0&-1\\2&0&11& -3& 1&3} \end{align}
        \begin{align}
        &\xleftrightarrow{\,R_1 \gets \frac{1}{5}R_1}
        \augvec{3}{3}{1&0&2/5& 2/5& 0&-1/5\\ 0&1&-2& 1& 0&-1\\2&0&11& -3& 1&3} \end{align}
        \begin{align}
        &\xleftrightarrow{\,R_3 \gets R_3 - 2R_1}
        \augvec{3}{3}{1&0&2/5& 2/5& 0&-1/5\\ 0&1&-2& 1& 0&-1\\0&0&51/5& -19/5& 1&17/5} \end{align}
\end{frame}
\begin{frame}{Theoretical Solution}
    \begin{align}
        &\xleftrightarrow{\,R_3 \gets \frac{5}{51}R_3}
        \augvec{3}{3}{1&0&2/5& 2/5& 0&-1/5\\ 0&1&-2& 1& 0&-1\\0&0&1& -19/51& 5/51&17/51} \end{align}
        \begin{align}
        &\xleftrightarrow[\,R_2 \gets R_2 + 2R_3]{\,R_1 \gets R_1 - \frac{2}{5}R_3}
        \augvec{3}{3}{1 & 0 & 0 & 28/51 & -2/51 & -17/51 \\ 0 & 1 & 0 & 13/51 & 10/51 & -17/51 \\ 0 & 0 & 1 & -19/51 & 5/51 & 17/51}
    \end{align}
    \begin{align}
        \therefore \vec{A}^{-1} = \myvec{ 28/51 & -2/51 & -17/51 \\ 13/51 & 10/51 & -17/51 \\ -19/51 & 5/51 & 17/51 }
    \end{align}
\end{frame}
\begin{frame}{Theoretical Solution}
    Now, Finding system of equations
\begin{align}
    \vec{A}\vec{X}=\vec{C}
\end{align}
where $\vec{C}=\myvec{5\\2\\-1}$ and $\vec{X}=\myvec{x\\y\\z}$
\begin{align}
    \vec{X}=\vec{A}^{-1}\vec{C}\\
    \vec{X}=\myvec{ 28/51 & -2/51 & -17/51 \\ 13/51 & 10/51 & -17/51 \\ -19/51 & 5/51 & 17/51 }\myvec{5\\2\\-1}\\
    \therefore \vec{X}=\myvec{3\\2\\-2}
\end{align}
\end{frame}
\begin{frame}[fragile]
\frametitle{C Code}
\begin{lstlisting}
#include <stdio.h>

#define N 3   // matrix size (you can generalize)

void inverse(double A[N][N], double inv[N][N]) {
    // Step 1: Create augmented matrix [A|I]
    double aug[N][2*N];
    for (int i = 0; i < N; i++) {
        for (int j = 0; j < N; j++) {
            aug[i][j] = A[i][j];          // copy A
            aug[i][j+N] = (i == j) ? 1 : 0; // identity
        }
    }

    // Step 2: Gaussâ€“Jordan elimination
    for (int i = 0; i < N; i++) {
        // Make pivot = 1
        double pivot = aug[i][i];
\end{lstlisting}
\end{frame}
\begin{frame}[fragile]
\frametitle{C Code}
\begin{lstlisting}
        for (int j = 0; j < 2*N; j++) {
            aug[i][j] /= pivot;
        }

        // Eliminate other rows
        for (int k = 0; k < N; k++) {
            if (k != i) {
                double factor = aug[k][i];
                for (int j = 0; j < 2*N; j++) {
                    aug[k][j] -= factor * aug[i][j];
                }
            }
        }}
    // Step 3: Extract inverse from augmented matrix
    for (int i = 0; i < N; i++) {
        for (int j = 0; j < N; j++) {
            inv[i][j] = aug[i][j+N];
        }
    }}
 \end{lstlisting}
\end{frame}
\begin{frame}[fragile]
\frametitle{Python Through Shared Output}
\begin{lstlisting} 
import ctypes
import numpy as np
import sympy as sp

# Load C library
lib = ctypes.CDLL("./matrix.so")

# Define function signature
lib.inverse.argtypes = [ctypes.POINTER((ctypes.c_double * 3) * 3),
                        ctypes.POINTER((ctypes.c_double * 3) * 3)]

# Input matrix
A = np.array([[5, -1, 4],
              [2, 3, 5],
              [5, -2, 6]], dtype=np.double)

inv = np.zeros((3,3), dtype=np.double)
 \end{lstlisting}
\end{frame}
\begin{frame}[fragile]
\frametitle{Python Through Shared Output}
\begin{lstlisting} 
# Call C function
lib.inverse(A.ctypes.data_as(ctypes.POINTER((ctypes.c_double * 3) * 3)),
            inv.ctypes.data_as(ctypes.POINTER((ctypes.c_double * 3) * 3)))

inverse=sp.Matrix(inv)
sp.pprint(inverse)
 \end{lstlisting}
\end{frame}
\begin{frame}[fragile]
\frametitle{Python Code}
\begin{lstlisting} 
import sympy as sp

A = sp.Matrix([[5, -1, 4], [2, 3, 5],[5, -2, 6]])
A_inv = A.inv()
sp.pprint(A_inv) 
\end{lstlisting}
\end{frame}
\end{document}